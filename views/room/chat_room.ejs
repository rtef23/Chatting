<div id='chat-panel-form' style='display:none;'>
	<div id='chat-panel' class='panel panel-default' style='width:20%;height:100%;'>
		<div class='panel-heading' style='height:15%;color:white;background-color:#0066ff;'>
			<h3>
				Rooms
			</h3>
		</div>
		<div class='panel-body list-group' style='height:70%;overflow-y:scroll;'>
		</div>
		<div class='panel-footer' style='height:15%;color:white;background-color:#0066ff;'>
		</div>
	</div>
</div>
<div id='room-item-form' style='display:none;'>
	<a class='list-group-item' id='%room_id%'>
		%room_name%
		<span class='badge'>
			%num_member%
		</span>
	</a>
</div>
<div id='room-panel-form' style='display:none;'>
	<div id='%room_id%' class='panel panel-default' style='width:20%;height:100%;'>
		<div class='panel-heading' style='height:15%;color:white;background-color:#0066ff;'>
			<h3>
				%room_name%
			</h3>
		</div>
		<div class='panel-body' style='height:70%;'>
		</div>
		<div class='panel-footer' style='height:15%;color:white;background-color:#0066ff;'>
		</div>
	</div>
</div>
<script>
	var getChatForm = function(){
		return $('div[id=chat-panel-form]').html();
	};
	var getRoomForm = function(){
		return $('div[id=room-panel-form]').html();
	};
	var addRoom = function(data){
		/*
		data
		{
			room_id : d1,
			members : [
				{friend_id : d3},...
			]
		}
		*/
		var form = $('div[id=room-item-form]').html();
		var friends = user.get('friends');
		var room_name = '';

		for(var i in data.members){
			room_name += friends.get(data.members[i]).friend_nick;
			if(i != data.members.length - 1)
				room_name += ',';
			if(room_name.length >= 10){
				room_name += '...';
				break;
			}
		}

		form = form.replace(/%room_id%/g, data.room_id);
		form = form.replace(/%room_name%/g, room_name);
		form = form.replace(/%num_member%/g, data.members.length);

		$('body[id=main_body] div[id=main_panel_group] div[id=chat-panel] div.panel-body').append(form);
	};
	var updateRooms = function(){
		var rooms = user.get('rooms');
		rooms.forAll(addRoom);
	};
</script>